!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Knuck=t()}(function(){return function r(o,i,u){function s(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(a)return a(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return s(o[e][1][t]||t)},n,n.exports,r,o,i,u)}return i[e].exports}for(var a="function"==typeof require&&require,t=0;t<u.length;t++)s(u[t]);return s}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("../utils"),t=(Object.defineProperty(o.prototype,"realpath",{get:function(){var t=this._realpath;return"function"==typeof t&&(t=t.call(this)),t||r.watchSuffix(this.prefix,"/")},set:function(t){this._realpath=t},enumerable:!1,configurable:!0}),o.prototype.redirect=function(t){t=r.watchPrefix(t,null===(t=this.$instance)||void 0===t?void 0:t.prefix);return this.$instance.realpath===t&&r.debug("460","realpath",this.$instance),this.$instance.realpath=t},o.prototype.middleware=function(n){var r=this;return n.constructor!==Array&&(n=[n]),n.every(function(t,e){return r.getMiddleware(t).call(r.getInstance(),r.getMiddleware(n[e+1])||function(){return!0})})},o.prototype.registerMiddleware=function(t,e){return"string"!=typeof t&&r.debug("400",'name: "'+t+'" must be a string'),this.$middlewares||(this.$middlewares=[]),this.$middlewares.push({name:t,callback:e})},o.prototype.setInstance=function(t){return t?this.$instance=t:null},o.prototype.getInstance=function(){return this.$instance||this},o.prototype.getMiddleware=function(e){var t,n=null;return null!==(t=null===(t=this.$instance)||void 0===t?void 0:t.$middlewares)&&void 0!==t&&t.forEach(function(t){t.name===e&&(n=t.callback)}),null!==(t=this.$middlewares)&&void 0!==t&&t.forEach(function(t){t.name===e&&(n=t.callback)}),n},o);function o(){this._realpath="",this.prefix="/"}n.default=t},{"../utils":12}],2:[function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u,i=i(t("./control")),s=t("../utils"),a=window,o=(u=i.default,o(c,u),c.prototype.invoke=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.view("index")},c.prototype.view=function(t,e){var n;return"object"==typeof a&&"object"==typeof(null==a?void 0:a.nunjucks)?(t=s.watchSuffix(t,".njk"),null===(n=null==a?void 0:a.nunjucks)||void 0===n?void 0:n.render(t,e)):null},c);function c(){return null!==u&&u.apply(this,arguments)||this}n.default=o},{"../utils":12,"./control":1}],3:[function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i,u=t("../utils"),o=(i=Error,o(s,i),s.prototype.setPrefix=function(t){return this.prefix=u.capslock(t)},s.prototype.setMessage=function(n,t){return void 0===t&&(t=[]),t.forEach(function(t,e){n=n.replace("%"+e,t)}),this.name=this.prefix+("["+this.typeCode)+"]",this.message=n+'.\nCheck "'+this.helplink+'" for more help!'},s.typeCode=19400,s);function s(t){var e=i.call(this,t)||this;return e.type="reference",e.typeCode=19400,e.prefix="Error",e.helplink="https://knuck.js.org/guide/errors",e.name=e.prefix+("["+e.typeCode)+"]",void 0!==t&&(e.message=t+'.\nCheck "'+e.helplink+'" for more help!'),e}n.default=o},{"../utils":12}],4:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.RouteError=n.InstanceError=n.Error=void 0;var o=r(t("./base"));n.Error=o.default;o=r(t("./instance"));n.InstanceError=o.default;t=r(t("./route"));n.RouteError=t.default},{"./base":3,"./instance":5,"./route":6}],5:[function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u,t=i(t("./base")),o=(u=t.default,o(s,u),s.typeCode=19458,s);function s(t,e){void 0===e&&(e="defined");var n=u.call(this)||this;return n.type="instance",n.typeCode=19458,n.prefix="InstanceError",n.helplink="https://knuck.js.org/guide/errors/instance",u.prototype.setMessage.call(n,t+" must be "+("defined"!==e?"of type ":"")+e),n}n.default=o},{"./base":3}],6:[function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u,t=i(t("./base")),o=(u=t.default,o(s,u),s.typeCode=19460,s);function s(t,e,n){void 0===n&&(n="unique");var r=u.call(this)||this;return r.type="routes",r.typeCode=19460,r.prefix="RouteError",r.helplink="https://knuck.js.org/guide/errors/routes",u.prototype.setMessage.call(r,"Route "+t+': "'+e[t]+'" must be '+n),r}n.default=o},{"./base":3}],7:[function(t,e,n){"use strict";var r,o,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},s=u(t("./router")),a=u(t("./controller")),c=u(t("./controller/control")),l=u(t("./paths")),f=u(t("./resolve")),p=t("./utils");function h(t){var e=o.call(this)||this;return"function"==typeof t&&t.call(e,s.default,a.default),e}e.exports=(o=c.default,i(h,o),h.prototype.output=function(){var n=this,r=null;return s.default.getInstance().all().forEach(function(t){var e=new l.default(p.watchPrefix(t.path,n.prefix),n.realpath);e.setPatterns(s.default.getPatterns()),e.matches()&&(r={route:t,path:e})}),r},h.prototype.render=function(t,e,n){var r;if(void 0===e&&(e=this.output()),void 0===n&&(n=!1),(null===(r=s.default.currentRoute)||void 0===r?void 0:r.path)===(null==e?void 0:e.route.path)&&!0!==n)return null;"function"!=typeof(t=t||function(t){"object"==typeof document?document.write(t.content):console.log(t)})&&p.debug("458","callback","function"),(null==e?void 0:e.path)instanceof l.default&&(s.default.currentRoute=e.route,t.apply(this,[new f.default(e,this)]))},h.prototype.run=function(t){var e=this;this.render(t),setInterval(function(){return e.render(t)},1005)},h.prototype.setWick=function(t){return this._realpath=t},h.prototype.setPrefix=function(t){return this.prefix=t},h)},{"./controller":2,"./controller/control":1,"./paths":8,"./resolve":9,"./router":10,"./utils":12}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("../utils"),t=(o.prototype.matches=function(){var r=this;return this.$parts.length>=this.$vars.length&&this.$parts.every(function(t,e){var n=r.$vars[e]||"",e=r.$regexp.exec(n)||[];return n===t||0<(null===(e=t.match(r.regex(e[0])))||void 0===e?void 0:e.length)})},o.prototype.regex=function(t){var e="([^/]+)";return void 0===t?null:("string"==typeof this.$patterns[t]&&(e=this.$patterns[t]),new RegExp(e))},o.prototype.setPattern=function(t,e){return this.$patterns[t]=e},o.prototype.setPatterns=function(t){var e=this;t.forEach(function(t){e.setPattern(t.name,t.pattern)})},o.prototype.getVar=function(n){var r=this,o=-1;return this.$vars.forEach(function(t,e){t=r.$regexp.exec(t)||[];-1===o&&0===t.indexOf(n)&&(o=e)}),this.$parts[o]||null},o.prototype.getVars=function(){var e=this,n={};return this.$varNames.forEach(function(t){n[t]=e.getVar(t)}),n},o.prototype.getVarsList=function(){var e=this,n=[];return this.$varNames.forEach(function(t){n.push(e.getVar(t))}),n},o.prototype.setPath=function(t){return this.$parts=t.split("/")},o.prototype.getPath=function(){return this.$parts.join("/")},o);function o(t,e){this.$regexp=/{([\w\?]+)}/g,this.$patterns={},"string"!=typeof t&&r.debug("400","Invalid Path type, use a string instead"),this.$vars=t.split("/"),this.$varNames=this.$regexp.exec(t)||[],"string"==typeof e&&this.setPath(e)}n.default=t},{"../utils":12}],9:[function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u,s=i(t("../controller")),a=i(t("../paths")),o=(u=s.default,o(c,u),c);function c(t,e){var n=this,r=t.path,t=t.route;return(n=u.call(this)||this).pathName=r.getPath(),n.setInstance(e),r instanceof a.default&&(t.callback?n.content=t.callback.apply(n,r.getVarsList()):(n.controller=t.controller)instanceof s.default&&(n.controller.setInstance(n.getInstance()),n.content=(t=n.controller).invoke.apply(t,r.getVarsList()))),n}n.default=o},{"../controller":2,"../paths":8}],10:[function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var u,t=i(t("./instance")),o=(u=t.default,o(s,u),s.get=function(t,e){this.register("GET",t,e)},s.post=function(t,e){this.register("POST",t,e)},s.any=function(t,e){this.get(t,e),this.post(t,e)},s.pattern=function(t,e){return this.getInstance().$patterns.push({name:t,pattern:e})},s.getPatterns=function(){return this.getInstance().$patterns},s.getInstance=function(){return u.getInstance.call(this)},s);function s(){var t=u.call(this)||this;return t.$patterns=[],t}n.default=o},{"./instance":11}],11:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(t("../controller")),i=t("../utils"),t=(u.prototype.all=function(){return this.$routes},u.getInstance=function(){return this.$instance||(this.$instance=new this),this.$instance},u.register=function(t,e,n){if(n instanceof o.default){var r=n;this.getInstance().$routes.push({path:e,controller:r,method:t})}else{if("function"!=typeof n)return i.debug("458","controllerOrCallback","function");n=n;this.getInstance().$routes.push({path:e,callback:n,method:t})}},u.currentRoute=null,u);function u(){this.$routes=[]}n.default=t},{"../controller":2,"../utils":12}],12:[function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},u=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],u=0,s=i.length;u<s;u++,o++)r[o]=i[u];return r};Object.defineProperty(n,"__esModule",{value:!0}),n.debug=n.watchSuffix=n.watchPrefix=n.capslock=void 0;var s=i(t("../errors"));n.capslock=function(t,e){void 0===e&&(e=" ");var n=t.split(e);return n.forEach(function(t,e){t=t.split("");t[0]=t[0].toUpperCase(),n[e]=t.join("")}),n.join(e)};function a(t,e){return 0!==t.indexOf(e)?e.concat(t):t}n.watchPrefix=a;n.watchSuffix=function(t,e){return t.length!==t.indexOf(e)+e.length?t.concat(e):t};n.debug=function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o,i=s;for(o in i)if(i[o].typeCode==a(t,"19")&&!(o in new Object))throw new((e=i[o]).bind.apply(e,u([void 0],n)))}},{"../errors":4}]},{},[7])(7)});