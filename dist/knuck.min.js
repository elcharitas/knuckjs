!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Knuck=t()}(function(){return function n(o,i,u){function s(e,t){if(!i[e]){if(!o[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(c)return c(e,!0);throw(r=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",r}r=i[e]={exports:{}},o[e][0].call(r.exports,function(t){return s(o[e][1][t]||t)},r,r.exports,n,o,i,u)}return i[e].exports}for(var c="function"==typeof require&&require,t=0;t<u.length;t++)s(u[t]);return s}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../utils"),t=(Object.defineProperty(o.prototype,"realpath",{get:function(){var t=this._realpath;return"function"==typeof t&&(t=t.call(this)),t||n.watchSuffix(this.prefix,"/")},set:function(t){this._realpath=t},enumerable:!1,configurable:!0}),o.prototype.redirect=function(t){t=n.watchPrefix(t,null===(t=this.$instance)||void 0===t?void 0:t.prefix);return this.$instance.realpath===t&&n.debug("460","realpath",this.$instance),this.$instance.realpath=t},o.prototype.middleware=function(r){var n=this;return r.constructor!==Array&&(r=[r]),r.every(function(t,e){return n.getMiddleware(t).call(n.getInstance(),n.getMiddleware(r[e+1])||function(){return!0})})},o.prototype.registerMiddleware=function(t,e){return"string"!=typeof t&&n.debug("400",'name: "'+t+'" must be a string'),this.$middlewares||(this.$middlewares=[]),this.$middlewares.push({name:t,callback:e})},o.prototype.setInstance=function(t){return t?this.$instance=t:null},o.prototype.getInstance=function(){return this.$instance||this},o.prototype.getMiddleware=function(e){var t,r=null;return null!==(t=null===(t=this.$instance)||void 0===t?void 0:t.$middlewares)&&void 0!==t&&t.forEach(function(t){t.name===e&&(r=t.callback)}),null!==(t=this.$middlewares)&&void 0!==t&&t.forEach(function(t){t.name===e&&(r=t.callback)}),r},o);function o(){this._realpath="",this.prefix="/"}r.default=t},{"../utils":13}],2:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u,i=i(t("./control")),s=t("../utils"),c="object"==typeof window?window:null,o=(u=i.default,o(a,u),a.prototype.invoke=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.view("index")},a.prototype.view=function(t,e){var r;return"object"==typeof c&&"object"==typeof(null===c?void 0:c.nunjucks)?(t=s.watchSuffix(t,".njk"),null===(r=null===c?void 0:c.nunjucks)||void 0===r?void 0:r.render(t,e)):null},a);function a(){return null!==u&&u.apply(this,arguments)||this}r.default=o},{"../utils":13,"./control":1}],3:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u,t=i(t("./index")),o=(u=t.default,o(s,u),s.prototype.invoke=function(){return this.redirect(this.redirectTo)},s);function s(t){var e=u.call(this)||this;return e.redirectTo="#",e.redirectTo=t,e}r.default=o},{"./index":2}],4:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var i,u=t("../utils"),o=(i=Error,o(s,i),s.prototype.setPrefix=function(t){return this.prefix=u.capslock(t)},s.prototype.setMessage=function(r,t){return void 0===t&&(t=[]),t.forEach(function(t,e){r=r.replace("%"+e,t)}),this.name=this.prefix+("["+this.typeCode)+"]",this.message=r+'.\nCheck "'+this.helplink+'" for more help!'},s.typeCode=19400,s);function s(t){var e=i.call(this,t)||this;return e.type="reference",e.typeCode=19400,e.prefix="Error",e.helplink="https://knuck.js.org/guide/errors",e.name=e.prefix+("["+e.typeCode)+"]",void 0!==t&&(e.message=t+'.\nCheck "'+e.helplink+'" for more help!'),e}r.default=o},{"../utils":13}],5:[function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.RouteError=r.InstanceError=r.Error=void 0;var o=n(t("./base"));r.Error=o.default;o=n(t("./instance"));r.InstanceError=o.default;t=n(t("./route"));r.RouteError=t.default},{"./base":4,"./instance":6,"./route":7}],6:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u,t=i(t("./base")),o=(u=t.default,o(s,u),s.typeCode=19458,s);function s(t,e){void 0===e&&(e="defined");var r=u.call(this)||this;return r.type="instance",r.typeCode=19458,r.prefix="InstanceError",r.helplink="https://knuck.js.org/guide/errors/instance",u.prototype.setMessage.call(r,t+" must be "+("defined"!==e?"of type ":"")+e),r}r.default=o},{"./base":4}],7:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u,t=i(t("./base")),o=(u=t.default,o(s,u),s.typeCode=19460,s);function s(t,e,r){void 0===r&&(r="unique");var n=u.call(this)||this;return n.type="routes",n.typeCode=19460,n.prefix="RouteError",n.helplink="https://knuck.js.org/guide/errors/routes",u.prototype.setMessage.call(n,"Route "+t+': "'+e[t]+'" must be '+r),n}r.default=o},{"./base":4}],8:[function(t,e,r){"use strict";var n,o,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},s=u(t("./router")),c=u(t("./controller")),a=u(t("./controller/control")),l=u(t("./paths")),f=u(t("./resolve")),p=t("./utils");function h(t){var e=o.call(this)||this;return e.setInstance(e),"function"==typeof t&&t.call(e,s.default,c.default),e}e.exports=(o=a.default,i(h,o),h.prototype.output=function(){var r=this,n=null;return s.default.getInstance().all().forEach(function(t){var e=new l.default(p.watchPrefix(t.path,r.prefix),r.realpath);e.setPatterns(s.default.getPatterns()),e.matches()&&(n={route:t,path:e})}),n},h.prototype.render=function(t,e,r){var n;if(void 0===e&&(e=this.output()),void 0===r&&(r=!1),(null===(n=s.default.currentRoute)||void 0===n?void 0:n.path)===(null==e?void 0:e.route.path)&&!0!==r)return null;"function"!=typeof(t=t||function(t){"object"==typeof document?document.write(t.content):console.log(t)})&&p.debug("458","callback","function"),(null==e?void 0:e.path)instanceof l.default&&(s.default.currentRoute=e.route,t.apply(this,[new f.default(e,this)]))},h.prototype.run=function(t){var e=this;this.render(t),setInterval(function(){return e.render(t)},1005)},h.prototype.setWick=function(t){return this._realpath=t},h.prototype.setPrefix=function(t){return this.prefix=t},h)},{"./controller":2,"./controller/control":1,"./paths":9,"./resolve":10,"./router":11,"./utils":13}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../utils"),t=(o.prototype.matches=function(){var n=this;return this.$parts.length>=this.$vars.length&&this.$parts.every(function(t,e){var r=n.$vars[e]||"",e=n.$regexp.exec(r)||[];return r===t||0<(null===(e=t.match(n.regex(e[0])))||void 0===e?void 0:e.length)})},o.prototype.regex=function(t){var e="([^/]+)";return void 0===t?null:("string"==typeof this.$patterns[t]&&(e=this.$patterns[t]),new RegExp(e))},o.prototype.setPattern=function(t,e){return this.$patterns[t]=e},o.prototype.setPatterns=function(t){var e=this;t.forEach(function(t){e.setPattern(t.name,t.pattern)})},o.prototype.getVar=function(r){var n=this,o=-1;return this.$vars.forEach(function(t,e){t=n.$regexp.exec(t)||[];-1===o&&0===t.indexOf(r)&&(o=e)}),this.$parts[o]||null},o.prototype.getVars=function(){var e=this,r={};return this.$varNames.forEach(function(t){r[t]=e.getVar(t)}),r},o.prototype.getVarsList=function(){var e=this,r=[];return this.$varNames.forEach(function(t){r.push(e.getVar(t))}),r},o.prototype.setPath=function(t){return this.$parts=t.split("/")},o.prototype.getPath=function(){return this.$parts.join("/")},o);function o(t,e){this.$regexp=/{([\w\?]+)}/g,this.$patterns={},"string"!=typeof t&&n.debug("400","Invalid Path type, use a string instead"),this.$vars=t.split("/"),this.$varNames=this.$regexp.exec(t)||[],"string"==typeof e&&this.setPath(e)}r.default=t},{"../utils":13}],10:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u,s=i(t("../controller")),c=i(t("../paths")),o=(u=s.default,o(a,u),a);function a(t,e){var r=this,n=t.path,t=t.route;return(r=u.call(this)||this).pathName=n.getPath(),r.setInstance(e),n instanceof c.default&&(t.callback?r.content=t.callback.apply(r,n.getVarsList()):(r.controller=t.controller)instanceof s.default&&(r.controller.setInstance(r.getInstance()),r.content=(t=r.controller).invoke.apply(t,n.getVarsList()))),r}r.default=o},{"../controller":2,"../paths":9}],11:[function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u,s=i(t("./instance")),c=i(t("../controller/redirect")),o=(u=s.default,o(a,u),a.get=function(t,e){this.register("GET",t,e)},a.post=function(t,e){this.register("POST",t,e)},a.redirect=function(t,e){this.get(t,new c.default(e))},a.any=function(t,e){this.get(t,e),this.post(t,e)},a.pattern=function(t,e){return this.getInstance().$patterns.push({name:t,pattern:e})},a.getPatterns=function(){return this.getInstance().$patterns},a.getInstance=function(){return u.getInstance.call(this)},a);function a(){var t=u.call(this)||this;return t.$patterns=[],t}r.default=o},{"../controller/redirect":3,"./instance":12}],12:[function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var o=n(t("../controller")),i=t("../utils"),t=(u.prototype.all=function(){return this.$routes},u.getInstance=function(){return this.$instance||(this.$instance=new this),this.$instance},u.register=function(t,e,r){if(r instanceof o.default){var n=r;this.getInstance().$routes.push({path:e,controller:n,method:t})}else{if("function"!=typeof r)return i.debug("458","controllerOrCallback","function");r=r;this.getInstance().$routes.push({path:e,callback:r,method:t})}},u.currentRoute=null,u);function u(){this.$routes=[]}r.default=t},{"../controller":2,"../utils":13}],13:[function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e},u=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var i=arguments[e],u=0,s=i.length;u<s;u++,o++)n[o]=i[u];return n};Object.defineProperty(r,"__esModule",{value:!0}),r.debug=r.watchSuffix=r.watchPrefix=r.capslock=void 0;var s=i(t("../errors"));r.capslock=function(t,e){void 0===e&&(e=" ");var r=t.split(e);return r.forEach(function(t,e){t=t.split("");t[0]=t[0].toUpperCase(),r[e]=t.join("")}),r.join(e)};function c(t,e){return void 0===e&&(e=""),0!==t.indexOf(e)?e.concat(t):t}r.watchPrefix=c;r.watchSuffix=function(t,e){return t.length!==t.indexOf(e)+e.length?t.concat(e):t};r.debug=function(t){for(var e,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o,i=s;for(o in i)if(i[o].typeCode==c(t,"19")&&!(o in new Object))throw new((e=i[o]).bind.apply(e,u([void 0],r)))}},{"../errors":5}]},{},[8])(8)});